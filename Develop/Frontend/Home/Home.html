<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>

    <!-- Bootstrap & CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="css/home.css">
</head>

<body style="background-color:#D2BFAD">
    <div class="container-sm text-center my-5">
        <div class="row ">
            <div class="col ms-0">
                <img src="../Administrador/img/logo.jpg" height="250px">
            </div>

            <div class="col mt-4">
                <div class="row">
                    <h1>CabaniApp</h1>
                    <h3>Cabañapp te ayuda a comunicarte y compartir con quienes buscan y ofrecen los mejores complejos
                        hoteleros y los mejores momentos!</h3>
                </div>

                <div class="row">
                    <div class="col mt-4">
                        <form name="fvalida">
                            <fieldset enabled>
                                <legend>Ya estás registrado? <button type="button" class="btn btn-primary"><a
                                            href="inicio-sesion.html">Iniciar sesión</a></button></legend>

                                <div class="mb-3">
                                    <label for="disabledTextInput" class="form-label">Nuevo en cabañapp? crea tu cuenta
                                        en dos simples pasos!</label>
                                    <input type="email" id="disabledTextInput" class="form-control"
                                        placeholder="Mail de Usuario" name="email">
                                </div>
                                <div class="mb-3">
                                    <input type="text" id="disabledTextInput" class="form-control"
                                        placeholder="Contraseña" name="password">
                                </div>
                                <div class="mb-3">
                                    <input type="text" id="disabledTextInput" class="form-control"
                                        placeholder="Repetir Contraseña" name="password2">
                                </div>

                                <div class="text-start ms-3">
                                    <select name="tipo">
                                        <option value="0">Seleccionar una opción</option>
                                        <option value="1">Administrador de complejo</option>
                                        <option value="2">Cliente</option>
                                    </select>

                                    <button type="button" class="btn btn-primary ms-3" onclick="validarSesion()">Crear cuenta</button>
                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function validarSesion() {
            // Validamos mail
            if (document.fvalida.email.value.length == 0) {
                alert("Tiene que escribir su email.")
                return 0
            }

            let cadenaEmail = document.fvalida.email.value.split("")
            let contarPuntos = 0
            let contarArrobas = 0

            for (let index = 0; index < cadenaEmail.length; index++) {
                if (cadenaEmail[index] == " ") {
                    alert("El email no puede contener espacios en blanco.")
                    document.fvalida.email.focus()
                    return 0;
                }
                if (cadenaEmail[index] == ".") {
                    contarPuntos++
                    if (contarPuntos > 2) {
                        alert("El email debe contener dos puntos como máximo.")
                        document.fvalida.email.focus()
                        return 0
                    }
                }
                if (cadenaEmail[index] == "@") {
                    contarArrobas++
                    if (contarArrobas > 1) {
                        alert("El email debe contener solo una arroba.")
                        document.fvalida.email.focus()
                        return 0
                    }
                }
            }

            if (contarArrobas < 1) {
                alert("El email debe contener una arroba.")
                document.fvalida.email.focus()
                return 0
            }

            if (contarPuntos <= 0) {
                alert("El email debe contener al menos un punto.")
                document.fvalida.email.focus()
                return 0
            }

            


            // Verificación contraseña.
            let cadenaPassword = document.fvalida.password.value.split("")
            let letrasMayusculas = "ZXCVBNMASDFGHJKLÑPOIUYTREWQ"
            let numeros = "1234567890"
            let cadenaLetrasMayusculas = letrasMayusculas.split("")
            let cadenaNumeros = numeros.split("")
            let contadorMayusculas = 0
            let contadorNumeros = 0


            if (document.fvalida.password.value == "") {
                alert("La contraseña no puede estar vacía.")
                document.fvalida.password.focus()
                return 0
            }

            for (let i = 0; i < cadenaPassword.length; i++) {
                for (let j = 0; j < cadenaLetrasMayusculas.length; j++) {
                    if (cadenaPassword[i] == cadenaLetrasMayusculas[j]) {
                        contadorMayusculas++;
                    }
                }
                for (let j = 0; j < cadenaNumeros.length; j++) {
                    if (cadenaPassword[i] === cadenaNumeros[j]) {
                        contadorNumeros++;
                    }
                }

            }
            if (contadorMayusculas < 1) {
                alert("La contraseña debe contener al menos una letra mayúscula.")
                document.fvalida.password.focus()
                return 0
            }
            if (contadorNumeros < 1) {
                alert("La contraseña debe contener al menos un número.")
                document.fvalida.password.focus()
                return 0
            }

            // verificación de las dos passwords.

            if(document.fvalida.password.value !== document.fvalida.password2.value){
                alert("Las contraseñas no coinciden")
                document.fvalida.password.focus()
                return 0;
            }

            // Verificamos que seleccione una opción.
            if(document.fvalida.tipo.value == "0"){
                alert("Debe seleccionarse una opción")
                document.fvalida.tipo.focus()
                return 0;
            }
            


            alert("Muchas gracias por enviar el formulario.")
            document.fvalida.submit()
            
            // Redirecciona al crear exitosamente una cuenta al inicio de sesión. 
            window.location.href = "inicio-sesion.html"
        }
    </script>


    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>

</html>